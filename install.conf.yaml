- defaults:
    shell:
      stdin: true
      stdout: true
    link:
      force: true
      relink: true
      create: true
- clean:
    - "~"
    - ~/bin
- create:
    - ~/.cache
    - ~/.config
    - ~/p
    - ~/bin
- shell:
    - [git submodule update --init --recursive, Installing submodules]
    - touch $HOME/.hushlogin
    # creating hard links so home-manager works
    # todo: remove when https://github.com/nix-community/home-manager/issues/4307 is fixed
    - mkdir -p "$HOME"/.config/home-manager
    - ln -f config/home-manager/home.nix "$HOME"/.config/home-manager/home.nix
    - ln -f config/home-manager/flake.nix "$HOME"/.config/home-manager/flake.nix
    - ln -f config/home-manager/flake.lock "$HOME"/.config/home-manager/flake.lock
- link:
    ~/.bashrc: home/.bashrc
    ~/.XCompose: home/.XCompose
    ~/.config/alacritty: config/alacritty
    ~/.config/carapace/overlays: config/carapace/overlays
    ~/.config/carapace/specs: config/carapace/specs
    ~/.config/git: config/git
    ~/.config/navi/config.yaml: config/navi-config.yaml
    ~/.config/nix/nix.conf: config/nix/nix.conf
    ~/.config/nushell: nuscripts
    ~/.config/nvim: nvim
    ~/.config/powershell: poshfiles
    ~/.config/starship.toml: config/starship.toml
    ~/.config/terminator/config: config/terminator/config
    ~/.config/tabby/config.yaml: config/tabby/config.yaml
    ~/.dotfiles:
      path: ""
      if: '[ `pwd` != "$HOME/.dotfiles" ]'
    ~/.gittemplate: home/.gittemplate
    ~/.gitconfig: home/.gitconfig
    ~/.inputrc: home/.inputrc
    ~/.npmrc: home/.npmrc
    ~/.profile: home/.profile
    ~/.tmux.conf: home/.tmux.conf
    ~/.vim: vimfiles
    ~/.vimrc: home/.vimrc
    ~/.w3m/config: config/w3mconfig
    ~/bin/dotnet-sdk: tools/dotnet-sdk-helpers/dotnet-sdk
    ~/bin/dotnet-uninstall: home/bin/dotnet-uninstall
    ~/bin/kubectx: tools/kubectx/kubectx
    ~/bin/kubens: tools/kubectx/kubens
    ~/bin/n: tools/n/bin/n
- shell:
    - ./cheats/build.sh
